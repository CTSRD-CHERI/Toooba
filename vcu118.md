# Getting Started with Toooba on VCU118

This guide show you how to get started running FreeBSD on CHERI Toooba. Doing this in simulation take quite long, so this guide shows you how to run this on a VCU118.

## Using Cat
For people that have access to the Computer Laboratory network of the University of Cambridge you can use the server `cat` which has a VCU118 attached to it.

### Prerequisites

- Have a University of Cambridge Raven account.
- Have a Computer Laboratory account.
- Have access to the `ctsrd-build` Jenkins
- Install openocd
- A build of [the `riscv-gnu-toolchain`](https://github.com/riscv/riscv-gnu-toolchain.git)
- Be part of the `dialout` user group on cat.

### SSH in
Get a Computer Laboratory kerberos token from within the University of Cambridge network (for example using the [VPN](https://help.uis.cam.ac.uk/service/network-services/remote-access/uis-vpn)). Make sure to replace `<crsid>` with your crsid:

`$ kinit <crsid>@DC.CL.CAM.AC.UK`

Then SSH into `cat`:

`$ ssh -K <crsid>@cat.cl.cam.ac.uk`

Check that you are part of the `dialout` group by using the following command:

`$ groups`

### Download Requirements

Go to where you want your workspace to be. Download `cheri-build`:

`$ git clone https://github.com/CTSRD-CHERI/cheribuild.git`

Prepare the vcu118 folder:
```
$ mkdir vcu118
$ mkdir vcu118/jenkins
```

Download `design_1.bit`, `design_1.ltx`, `bbl-gfe-riscv64` and `kernel-riscv64.GFE-NODEBUG` from [the ctsrd-build Jenkins](
https://ctsrd-build.cl.cam.ac.uk/job/CheriBSD-FPGA-hmka2-test/job/cheribsd-gfe-run-fpga/BITSTREAM=bluespec,label_exp=tiger/ws/) into the `vcu118/jenkins` folder.

### Running on the FPGA

From the root of your toolchain folder use the following commands to run FreeBSD on Toooba on the VCU118. Make sure to replace `<path-to-toolchain>` with the actual path to your toolchain (by default this is `/opt/riscv`):
```
$ cd cheribuild
$ export PATH=/local/ecad/xilinx/Vivado/2019.1/bin:$PATH
$ ./vcu118-run.py --bitfile ../vcu118/jenkins/design_1.bit --ltxfile ../vcu118/jenkins/design_1.ltx --bios ../vcu118/jenkins/bbl-gfe-riscv64 --kernel ../vcu118/jenkins/kernel-riscv64.GFE-NODEBUG --gdb <path-to-toolchain>/bin/riscv64-unknown-elf-gdb --openocd /usr/bin/openocd
```

You should be using Vivado 2019.1 for this. Using an older version of Vivado is likely to produce errors.

Once you get the picocom prompt, you can start running regular Unix commands. Congratulations, you're running FreeBSD on the VCU118!
